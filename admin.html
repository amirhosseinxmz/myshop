<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - Luxury Collection</title>
    <!-- Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --dark-bg: #1a1a1a;
            --gold: #d4af37;
            --light-gold: #f4e4a6;
            --text-light: #e0e0e0;
        }
        
        body {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            background-color: var(--dark-bg);
            color: var(--text-light);
            margin: 0;
            padding: 0;
        }
        
        .admin-sidebar {
            background: #2a2a2a;
            min-height: 100vh;
            border-right: 1px solid var(--gold);
            padding: 0;
        }
        
        .admin-main {
            background: var(--dark-bg);
            min-height: 100vh;
            padding: 20px;
        }
        
        .nav-link {
            color: var(--text-light) !important;
            transition: all 0.3s;
            padding: 12px 20px;
            border-radius: 8px;
            margin: 5px 0;
        }
        
        .nav-link:hover, .nav-link.active {
            color: var(--gold) !important;
            background: rgba(212, 175, 55, 0.1);
        }
        
        .admin-card {
            background: #2a2a2a;
            border: 1px solid #444;
            border-radius: 15px;
            transition: all 0.3s;
            margin-bottom: 20px;
        }
        
        .admin-card:hover {
            border-color: var(--gold);
            transform: translateY(-2px);
        }
        
        .form-control, .form-select {
            background: #333;
            border: 1px solid #555;
            color: var(--text-light);
            padding: 12px;
        }
        
        .form-control:focus, .form-select:focus {
            background: #333;
            border-color: var(--gold);
            color: var(--text-light);
            box-shadow: 0 0 0 0.2rem rgba(212, 175, 55, 0.25);
        }
        
        .btn-gold {
            background: var(--gold);
            color: var(--dark-bg);
            border: none;
            transition: all 0.3s;
            padding: 12px 30px;
            border-radius: 8px;
            font-weight: 600;
        }
        
        .btn-gold:hover {
            background: var(--light-gold);
            transform: translateY(-2px);
        }
        
        .btn-outline-gold {
            background: transparent;
            border: 2px solid var(--gold);
            color: var(--gold);
            transition: all 0.3s;
            padding: 8px 20px;
            border-radius: 8px;
        }
        
        .btn-outline-gold:hover {
            background: var(--gold);
            color: var(--dark-bg);
        }
        
        .btn-outline-danger {
            background: transparent;
            border: 2px solid #dc3545;
            color: #dc3545;
            transition: all 0.3s;
            padding: 8px 20px;
            border-radius: 8px;
        }
        
        .btn-outline-danger:hover {
            background: #dc3545;
            color: white;
        }
        
        .gold-text {
            color: var(--gold);
        }
        
        .section-title {
            color: var(--gold);
            font-weight: 300;
            letter-spacing: 2px;
            text-transform: uppercase;
            margin-bottom: 30px;
        }
        
        .product-image-preview {
            width: 80px;
            height: 80px;
            object-fit: cover;
            border-radius: 8px;
            border: 1px solid #555;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 9999;
            min-width: 300px;
            border-radius: 10px;
        }
        
        .truncate {
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            max-width: 200px;
        }
        
        .sidebar-header {
            padding: 30px 20px;
            border-bottom: 1px solid #444;
            text-align: center;
        }
        
        .tab-content {
            padding: 20px 0;
        }
    </style>
</head>
<body>
    <div class="container-fluid">
        <div class="row">
            <!-- Sidebar -->
            <div class="col-md-3 col-lg-2 admin-sidebar">
                <div class="sidebar-header">
                    <h4 class="gold-text mb-0">
                        <i class="fas fa-gem me-2"></i>ADMIN
                    </h4>
                    <small class="text-light">Luxury Collection</small>
                </div>
                
                <div class="p-3">
                    <nav class="nav flex-column">
                        <a class="nav-link active" href="#products" data-bs-toggle="tab">
                            <i class="fas fa-box me-2"></i>Products
                        </a>
                        <a class="nav-link" href="#categories" data-bs-toggle="tab">
                            <i class="fas fa-tags me-2"></i>Categories
                        </a>
                        <a class="nav-link" href="#settings" data-bs-toggle="tab">
                            <i class="fas fa-cog me-2"></i>Settings
                        </a>
                        <a class="nav-link" href="/" target="_blank">
                            <i class="fas fa-eye me-2"></i>View Site
                        </a>
                    </nav>
                </div>
            </div>

            <!-- Main Content -->
            <div class="col-md-9 col-lg-10 admin-main">
                <div class="tab-content">
                    <!-- Products Tab -->
                    <div class="tab-pane fade show active" id="products">
                        <div class="d-flex justify-content-between align-items-center mb-4">
                            <h2 class="section-title mb-0">PRODUCTS MANAGEMENT</h2>
                            <div>
                                <span class="badge bg-gold text-dark me-2" id="productsCount">0 products</span>
                            </div>
                        </div>

                        <!-- Add Product Form -->
                        <div class="admin-card p-4 mb-4">
                            <h5 class="gold-text mb-3"><i class="fas fa-plus-circle me-2"></i>Add New Product</h5>
                            <form id="addProductForm">
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <label class="form-label">Product Title *</label>
                                        <input type="text" class="form-control" id="title" required placeholder="Enter product title">
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Category *</label>
                                        <select class="form-select" id="category" required>
                                            <option value="">Select Category</option>
                                            <option value="Electronics">Electronics</option>
                                            <option value="Fashion">Fashion</option>
                                            <option value="Home">Home & Living</option>
                                            <option value="Accessories">Accessories</option>
                                            <option value="Jewelry">Jewelry</option>
                                            <option value="Watches">Watches</option>
                                            <option value="Beauty">Beauty</option>
                                            <option value="Other">Other</option>
                                        </select>
                                    </div>
                                    <div class="col-12">
                                        <label class="form-label">Description</label>
                                        <textarea class="form-control" id="description" rows="3" placeholder="Enter product description..."></textarea>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Image URL</label>
                                        <input type="url" class="form-control" id="image_url" placeholder="https://example.com/image.jpg">
                                        <small class="text-muted">Paste direct image link</small>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Buy Link *</label>
                                        <input type="url" class="form-control" id="link_to_buy" placeholder="https://example.com/product" required>
                                        <small class="text-muted">Where customers can purchase</small>
                                    </div>
                                    <div class="col-12">
                                        <label class="form-label">Display Position</label>
                                        <select class="form-select" id="position">
                                            <option value="featured">Featured (Slider)</option>
                                            <option value="regular">Regular Products</option>
                                            <option value="hidden">Hidden</option>
                                        </select>
                                    </div>
                                    <div class="col-12">
                                        <button type="submit" class="btn btn-gold">
                                            <i class="fas fa-save me-2"></i>Add Product
                                        </button>
                                        <button type="reset" class="btn btn-outline-gold ms-2">
                                            <i class="fas fa-times me-2"></i>Clear Form
                                        </button>
                                    </div>
                                </div>
                            </form>
                        </div>

                        <!-- Products List -->
                        <div class="admin-card p-4">
                            <h5 class="gold-text mb-3"><i class="fas fa-list me-2"></i>Existing Products</h5>
                            <div id="productsList" class="row g-3">
                                <!-- Products will be loaded here -->
                            </div>
                        </div>
                    </div>

                    <!-- Categories Tab -->
                    <div class="tab-pane fade" id="categories">
                        <h2 class="section-title">CATEGORIES MANAGEMENT</h2>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="admin-card p-4">
                                    <h5 class="gold-text mb-3"><i class="fas fa-plus-circle me-2"></i>Add Category</h5>
                                    <form id="addCategoryForm">
                                        <div class="mb-3">
                                            <label class="form-label">Category Name *</label>
                                            <input type="text" class="form-control" id="categoryName" required placeholder="Enter category name">
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label">Icon Class (Font Awesome)</label>
                                            <input type="text" class="form-control" id="categoryIcon" placeholder="fas fa-star">
                                            <small class="text-muted">e.g., fas fa-mobile, fas fa-tshirt</small>
                                        </div>
                                        <button type="submit" class="btn btn-gold">
                                            <i class="fas fa-plus me-2"></i>Add Category
                                        </button>
                                    </form>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="admin-card p-4">
                                    <h5 class="gold-text mb-3"><i class="fas fa-tags me-2"></i>Current Categories</h5>
                                    <div id="categoriesList" class="d-flex flex-wrap gap-2">
                                        <span class="badge bg-dark border border-gold p-2">Electronics</span>
                                        <span class="badge bg-dark border border-gold p-2">Fashion</span>
                                        <span class="badge bg-dark border border-gold p-2">Home & Living</span>
                                        <span class="badge bg-dark border border-gold p-2">Accessories</span>
                                        <span class="badge bg-dark border border-gold p-2">Jewelry</span>
                                        <span class="badge bg-dark border border-gold p-2">Watches</span>
                                        <span class="badge bg-dark border border-gold p-2">Beauty</span>
                                        <span class="badge bg-dark border border-gold p-2">Other</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Settings Tab -->
                    <div class="tab-pane fade" id="settings">
                        <h2 class="section-title">SITE SETTINGS</h2>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="admin-card p-4">
                                    <h5 class="gold-text mb-3"><i class="fas fa-info-circle me-2"></i>Site Information</h5>
                                    <form id="siteSettingsForm">
                                        <div class="mb-3">
                                            <label class="form-label">Site Title</label>
                                            <input type="text" class="form-control" id="siteTitle" value="LUXURY COLLECTION">
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label">Hero Text</label>
                                            <input type="text" class="form-control" id="heroText" value="ELEGANCE REDEFINED">
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label">Contact Email</label>
                                            <input type="email" class="form-control" id="contactEmail" value="contact@luxurycollection.com">
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label">Phone Number</label>
                                            <input type="text" class="form-control" id="contactPhone" value="+1 (555) 123-4567">
                                        </div>
                                        <button type="submit" class="btn btn-gold">
                                            <i class="fas fa-save me-2"></i>Save Settings
                                        </button>
                                    </form>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="admin-card p-4">
                                    <h5 class="gold-text mb-3"><i class="fas fa-palette me-2"></i>Appearance</h5>
                                    <div class="mb-3">
                                        <label class="form-label">Theme Color</label>
                                        <select class="form-select" id="themeColor">
                                            <option value="gold">Gold Theme</option>
                                            <option value="silver">Silver Theme</option>
                                            <option value="platinum">Platinum Theme</option>
                                        </select>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Layout Style</label>
                                        <select class="form-select" id="layoutStyle">
                                            <option value="minimal">Minimal</option>
                                            <option value="classic">Classic</option>
                                            <option value="modern">Modern</option>
                                        </select>
                                    </div>
                                    <button class="btn btn-outline-gold">
                                        <i class="fas fa-sync me-2"></i>Apply Changes
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        const API_BASE_URL = '/api';

        // Initialize admin panel
        document.addEventListener('DOMContentLoaded', function() {
            loadProducts();
            setupEventListeners();
            updateProductsCount();
        });

        // Setup event listeners
        function setupEventListeners() {
            // Add product form
            document.getElementById('addProductForm').addEventListener('submit', handleAddProduct);
            
            // Add category form
            document.getElementById('addCategoryForm').addEventListener('submit', handleAddCategory);
            
            // Site settings form
            document.getElementById('siteSettingsForm').addEventListener('submit', handleSaveSettings);
            
            // Form reset
            document.querySelector('button[type="reset"]').addEventListener('click', function() {
                showNotification('Form cleared', 'info');
            });
        }

        // Handle add product
        async function handleAddProduct(event) {
            event.preventDefault();
            
            const productData = {
                title: document.getElementById('title').value,
                category: document.getElementById('category').value,
                description: document.getElementById('description').value,
                image_url: document.getElementById('image_url').value,
                link_to_buy: document.getElementById('link_to_buy').value,
                position: document.getElementById('position').value
            };

            try {
                const response = await fetch(`${API_BASE_URL}/products`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(productData)
                });

                const result = await response.json();

                if (response.ok) {
                    showNotification('üéâ Product added successfully!', 'success');
                    document.getElementById('addProductForm').reset();
                    loadProducts();
                } else {
                    throw new Error(result.error || 'Failed to add product');
                }
            } catch (error) {
                console.error('Error:', error);
                showNotification('‚ùå Error adding product: ' + error.message, 'error');
            }
        }

        // Handle add category
        async function handleAddCategory(event) {
            event.preventDefault();
            
            const categoryName = document.getElementById('categoryName').value;
            const categoryIcon = document.getElementById('categoryIcon').value;
            
            showNotification(`‚úÖ Category "${categoryName}" added successfully!`, 'success');
            document.getElementById('addCategoryForm').reset();
            
            // Add to categories list
            const categoriesList = document.getElementById('categoriesList');
            const newCategory = document.createElement('span');
            newCategory.className = 'badge bg-dark border border-gold p-2';
            newCategory.textContent = categoryName;
            categoriesList.appendChild(newCategory);
        }

        // Handle save settings
        async function handleSaveSettings(event) {
            event.preventDefault();
            showNotification('‚úÖ Settings saved successfully!', 'success');
        }

        // Load products
        async function loadProducts() {
            try {
                showNotification('üîÑ Loading products...', 'info');
                const response = await fetch(`${API_BASE_URL}/products`);
                const products = await response.json();
                renderProducts(products);
                updateProductsCount(products.length);
            } catch (error) {
                console.error('Error loading products:', error);
                showNotification('‚ùå Error loading products', 'error');
            }
        }

        // Render products list
        function renderProducts(products) {
            const container = document.getElementById('productsList');
            
            if (products.length === 0) {
                container.innerHTML = `
                    <div class="col-12 text-center py-5">
                        <i class="fas fa-box-open fa-3x gold-text mb-3"></i>
                        <h5 class="gold-text">No Products Yet</h5>
                        <p class="text-light">Start by adding your first product above</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = products.map(product => `
                <div class="col-md-6 col-lg-4">
                    <div class="admin-card p-3 h-100">
                        <div class="d-flex align-items-start gap-3">
                            ${product.image_url ? `
                                <img src="${product.image_url}" class="product-image-preview" alt="${product.title}" 
                                     onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iODAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iIzMzMyIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTIiIGZpbGw9IiM5OTkiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGR5PSIwLjNlbSI+Tm8gSW1hZ2U8L3RleHQ+PC9zdmc+'">
                            ` : `
                                <div class="product-image-preview bg-secondary d-flex align-items-center justify-content-center">
                                    <i class="fas fa-image text-light"></i>
                                </div>
                            `}
                            <div class="flex-grow-1">
                                <h6 class="gold-text mb-1">${product.title}</h6>
                                <p class="small text-light mb-1">
                                    <i class="fas fa-tag me-1"></i>${product.category || 'No category'}
                                </p>
                                <p class="small text-muted mb-2 truncate">${product.description || 'No description'}</p>
                                <div class="d-flex gap-2 mt-2">
                                    <button class="btn btn-outline-gold btn-sm" onclick="editProduct(${product.id})" title="Edit">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn btn-outline-danger btn-sm" onclick="deleteProduct(${product.id})" title="Delete">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                    <span class="badge ${product.position === 'featured' ? 'bg-warning text-dark' : 'bg-secondary'} ms-auto">
                                        ${product.position || 'regular'}
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Delete product
        async function deleteProduct(productId) {
            if (!confirm('Are you sure you want to delete this product? This action cannot be undone.')) return;

            try {
                const response = await fetch(`${API_BASE_URL}/products/${productId}`, {
                    method: 'DELETE'
                });

                if (response.ok) {
                    showNotification('üóëÔ∏è Product deleted successfully!', 'success');
                    loadProducts();
                } else {
                    throw new Error('Failed to delete product');
                }
            } catch (error) {
                console.error('Error:', error);
                showNotification('‚ùå Error deleting product', 'error');
            }
        }

        // Edit product
        function editProduct(productId) {
            showNotification('‚úèÔ∏è Edit functionality coming soon!', 'info');
            // In a real app, you would open a modal with the product data to edit
        }

        // Update products count
        function updateProductsCount(count = 0) {
            const countElement = document.getElementById('productsCount');
            countElement.textContent = `${count} product${count !== 1 ? 's' : ''}`;
        }

        // Show notification
        function showNotification(message, type) {
            // Remove existing notifications
            const existingNotifications = document.querySelectorAll('.notification');
            existingNotifications.forEach(notif => notif.remove());

            // Create notification element
            const notification = document.createElement('div');
            notification.className = `notification alert alert-${type === 'error' ? 'danger' : type === 'success' ? 'success' : 'info'} alert-dismissible fade show`;
            notification.innerHTML = `
                <div class="d-flex align-items-center">
                    <div class="flex-grow-1">${message}</div>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="alert"></button>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            // Auto remove after 5 seconds
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.remove();
                }
            }, 5000);
        }

        // Add some sample data on first load
        function initializeSampleData() {
            const productsList = document.getElementById('productsList');
            if (productsList.innerHTML.includes('No Products Yet')) {
                showNotification('üí° Tip: Add your first product using the form above!', 'info');
            }
        }

        // Initialize sample data after load
        setTimeout(initializeSampleData, 1000);
    </script>
</body>
</html>
