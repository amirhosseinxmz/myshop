<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - Luxury Collection</title>
    <!-- Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --dark-bg: #1a1a1a;
            --gold: #d4af37;
            --light-gold: #f4e4a6;
            --text-light: #e0e0e0;
        }
        
        body {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            background-color: var(--dark-bg);
            color: var(--text-light);
        }
        
        .admin-sidebar {
            background: #2a2a2a;
            min-height: 100vh;
            border-right: 1px solid var(--gold);
        }
        
        .admin-main {
            background: var(--dark-bg);
            min-height: 100vh;
        }
        
        .nav-link {
            color: var(--text-light) !important;
            transition: all 0.3s;
        }
        
        .nav-link:hover, .nav-link.active {
            color: var(--gold) !important;
            background: rgba(212, 175, 55, 0.1);
        }
        
        .admin-card {
            background: #2a2a2a;
            border: 1px solid #444;
            border-radius: 15px;
            transition: all 0.3s;
        }
        
        .admin-card:hover {
            border-color: var(--gold);
            transform: translateY(-2px);
        }
        
        .form-control, .form-select {
            background: #333;
            border: 1px solid #555;
            color: var(--text-light);
        }
        
        .form-control:focus, .form-select:focus {
            background: #333;
            border-color: var(--gold);
            color: var(--text-light);
            box-shadow: 0 0 0 0.2rem rgba(212, 175, 55, 0.25);
        }
        
        .btn-gold {
            background: var(--gold);
            color: var(--dark-bg);
            border: none;
            transition: all 0.3s;
        }
        
        .btn-gold:hover {
            background: var(--light-gold);
            transform: translateY(-2px);
        }
        
        .btn-outline-gold {
            background: transparent;
            border: 2px solid var(--gold);
            color: var(--gold);
            transition: all 0.3s;
        }
        
        .btn-outline-gold:hover {
            background: var(--gold);
            color: var(--dark-bg);
        }
        
        .gold-text {
            color: var(--gold);
        }
        
        .section-title {
            color: var(--gold);
            font-weight: 300;
            letter-spacing: 2px;
            text-transform: uppercase;
        }
        
        .product-image-preview {
            max-width: 100px;
            max-height: 100px;
            object-fit: cover;
            border-radius: 10px;
            border: 1px solid #555;
        }
    </style>
</head>
<body>
    <div class="container-fluid">
        <div class="row">
            <!-- Sidebar -->
            <div class="col-md-3 col-lg-2 admin-sidebar p-0">
                <div class="p-4">
                    <h4 class="gold-text text-center mb-4">
                        <i class="fas fa-gem me-2"></i>ADMIN PANEL
                    </h4>
                    
                    <nav class="nav flex-column">
                        <a class="nav-link active" href="#products" data-bs-toggle="tab">
                            <i class="fas fa-box me-2"></i>Products
                        </a>
                        <a class="nav-link" href="#categories" data-bs-toggle="tab">
                            <i class="fas fa-tags me-2"></i>Categories
                        </a>
                        <a class="nav-link" href="#settings" data-bs-toggle="tab">
                            <i class="fas fa-cog me-2"></i>Settings
                        </a>
                        <a class="nav-link" href="/" target="_blank">
                            <i class="fas fa-eye me-2"></i>View Site
                        </a>
                    </nav>
                </div>
            </div>

            <!-- Main Content -->
            <div class="col-md-9 col-lg-10 admin-main p-4">
                <div class="tab-content">
                    <!-- Products Tab -->
                    <div class="tab-pane fade show active" id="products">
                        <div class="d-flex justify-content-between align-items-center mb-4">
                            <h2 class="section-title mb-0">PRODUCTS MANAGEMENT</h2>
                            <button class="btn btn-gold" data-bs-toggle="modal" data-bs-target="#addProductModal">
                                <i class="fas fa-plus me-2"></i>Add Product
                            </button>
                        </div>

                        <!-- Add Product Form -->
                        <div class="admin-card p-4 mb-4">
                            <h5 class="gold-text mb-3">Add New Product</h5>
                            <form id="addProductForm">
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <label class="form-label">Product Title *</label>
                                        <input type="text" class="form-control" id="title" required>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Category *</label>
                                        <select class="form-select" id="category" required>
                                            <option value="">Select Category</option>
                                            <option value="Electronics">Electronics</option>
                                            <option value="Fashion">Fashion</option>
                                            <option value="Home">Home & Living</option>
                                            <option value="Accessories">Accessories</option>
                                            <option value="Jewelry">Jewelry</option>
                                            <option value="Watches">Watches</option>
                                            <option value="Beauty">Beauty</option>
                                            <option value="Other">Other</option>
                                        </select>
                                    </div>
                                    <div class="col-12">
                                        <label class="form-label">Description</label>
                                        <textarea class="form-control" id="description" rows="3" placeholder="Product description..."></textarea>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Image URL</label>
                                        <input type="url" class="form-control" id="image_url" placeholder="https://example.com/image.jpg">
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Buy Link *</label>
                                        <input type="url" class="form-control" id="link_to_buy" placeholder="https://example.com/product" required>
                                    </div>
                                    <div class="col-12">
                                        <label class="form-label">Display Position</label>
                                        <select class="form-select" id="position">
                                            <option value="featured">Featured (Slider)</option>
                                            <option value="regular">Regular Products</option>
                                            <option value="hidden">Hidden</option>
                                        </select>
                                    </div>
                                    <div class="col-12">
                                        <button type="submit" class="btn btn-gold">
                                            <i class="fas fa-save me-2"></i>Add Product
                                        </button>
                                    </div>
                                </div>
                            </form>
                        </div>

                        <!-- Products List -->
                        <div class="admin-card p-4">
                            <h5 class="gold-text mb-3">Existing Products</h5>
                            <div id="productsList" class="row g-3">
                                <!-- Products will be loaded here -->
                            </div>
                        </div>
                    </div>

                    <!-- Categories Tab -->
                    <div class="tab-pane fade" id="categories">
                        <h2 class="section-title mb-4">CATEGORIES MANAGEMENT</h2>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="admin-card p-4">
                                    <h5 class="gold-text mb-3">Add Category</h5>
                                    <form id="addCategoryForm">
                                        <div class="mb-3">
                                            <label class="form-label">Category Name *</label>
                                            <input type="text" class="form-control" id="categoryName" required>
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label">Icon Class (Font Awesome)</label>
                                            <input type="text" class="form-control" id="categoryIcon" placeholder="fas fa-star">
                                        </div>
                                        <button type="submit" class="btn btn-gold">
                                            <i class="fas fa-plus me-2"></i>Add Category
                                        </button>
                                    </form>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="admin-card p-4">
                                    <h5 class="gold-text mb-3">Current Categories</h5>
                                    <div id="categoriesList">
                                        <!-- Categories will be loaded here -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Settings Tab -->
                    <div class="tab-pane fade" id="settings">
                        <h2 class="section-title mb-4">SITE SETTINGS</h2>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="admin-card p-4">
                                    <h5 class="gold-text mb-3">Site Information</h5>
                                    <form id="siteSettingsForm">
                                        <div class="mb-3">
                                            <label class="form-label">Site Title</label>
                                            <input type="text" class="form-control" id="siteTitle" value="LUXURY COLLECTION">
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label">Hero Text</label>
                                            <input type="text" class="form-control" id="heroText" value="ELEGANCE REDEFINED">
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label">Contact Email</label>
                                            <input type="email" class="form-control" id="contactEmail" value="contact@luxurycollection.com">
                                        </div>
                                        <button type="submit" class="btn btn-gold">
                                            <i class="fas fa-save me-2"></i>Save Settings
                                        </button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        const API_BASE_URL = '/api';

        // Initialize admin panel
        document.addEventListener('DOMContentLoaded', function() {
            loadProducts();
            setupEventListeners();
        });

        // Setup event listeners
        function setupEventListeners() {
            // Add product form
            document.getElementById('addProductForm').addEventListener('submit', handleAddProduct);
            
            // Add category form
            document.getElementById('addCategoryForm').addEventListener('submit', handleAddCategory);
            
            // Site settings form
            document.getElementById('siteSettingsForm').addEventListener('submit', handleSaveSettings);
        }

        // Handle add product
        async function handleAddProduct(event) {
            event.preventDefault();
            
            const productData = {
                title: document.getElementById('title').value,
                category: document.getElementById('category').value,
                description: document.getElementById('description').value,
                image_url: document.getElementById('image_url').value,
                link_to_buy: document.getElementById('link_to_buy').value,
                position: document.getElementById('position').value
            };

            try {
                const response = await fetch(`${API_BASE_URL}/products`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(productData)
                });

                const result = await response.json();

                if (response.ok) {
                    showNotification('Product added successfully!', 'success');
                    document.getElementById('addProductForm').reset();
                    loadProducts();
                } else {
                    throw new Error(result.error || 'Failed to add product');
                }
            } catch (error) {
                console.error('Error:', error);
                showNotification('Error adding product: ' + error.message, 'error');
            }
        }

        // Handle add category
        async function handleAddCategory(event) {
            event.preventDefault();
            
            const categoryName = document.getElementById('categoryName').value;
            const categoryIcon = document.getElementById('categoryIcon').value;
            
            // In a real app, you'd save this to a categories API
            showNotification(`Category "${categoryName}" would be saved in a real application`, 'info');
            document.getElementById('addCategoryForm').reset();
        }

        // Handle save settings
        async function handleSaveSettings(event) {
            event.preventDefault();
            showNotification('Settings saved successfully!', 'success');
        }

        // Load products
        async function loadProducts() {
            try {
                const response = await fetch(`${API_BASE_URL}/products`);
                const products = await response.json();
                renderProducts(products);
            } catch (error) {
                console.error('Error loading products:', error);
                showNotification('Error loading products', 'error');
            }
        }

        // Render products list
        function renderProducts(products) {
            const container = document.getElementById('productsList');
            
            if (products.length === 0) {
                container.innerHTML = `
                    <div class="col-12 text-center py-4">
                        <i class="fas fa-box-open fa-2x gold-text mb-3"></i>
                        <p class="text-light">No products yet</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = products.map(product => `
                <div class="col-md-6 col-lg-4">
                    <div class="admin-card p-3">
                        <div class="d-flex align-items-start gap-3">
                            ${product.image_url ? `
                                <img src="${product.image_url}" class="product-image-preview" alt="${product.title}">
                            ` : `
                                <div class="product-image-preview bg-secondary d-flex align-items-center justify-content-center">
                                    <i class="fas fa-image text-light"></i>
                                </div>
                            `}
                            <div class="flex-grow-1">
                                <h6 class="gold-text mb-1">${product.title}</h6>
                                <p class="small text-light mb-1">${product.category || 'No category'}</p>
                                <p class="small text-muted mb-2 truncate">${product.description || 'No description'}</p>
                                <div class="d-flex gap-2">
                                    <button class="btn btn-outline-gold btn-sm" onclick="editProduct(${product.id})">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn btn-outline-danger btn-sm" onclick="deleteProduct(${product.id})">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Delete product
        async function deleteProduct(productId) {
            if (!confirm('Are you sure you want to delete this product?')) return;

            try {
                const response = await fetch(`${API_BASE_URL}/products/${productId}`, {
                    method: 'DELETE'
                });

                if (response.ok) {
                    showNotification('Product deleted successfully!', 'success');
                    loadProducts();
                } else {
                    throw new Error('Failed to delete product');
                }
            } catch (error) {
                console.error('Error:', error);
                showNotification('Error deleting product', 'error');
            }
        }

        // Edit product (placeholder)
        function editProduct(productId) {
            showNotification('Edit functionality would be implemented here', 'info');
        }

        // Show notification
        function showNotification(message, type) {
            // Create notification element
            const notification = document.createElement('div');
            notification.className = `alert alert-${type === 'error' ? 'danger' : type} alert-dismissible fade show position-fixed`;
            notification.style.cssText = 'top: 20px; right: 20px; z-index: 9999; min-width: 300px;';
            notification.innerHTML = `
                ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            `;
            
            document.body.appendChild(notification);
            
            // Auto remove after 5 seconds
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.remove();
                }
            }, 5000);
        }
    </script>
</body>
</html>
